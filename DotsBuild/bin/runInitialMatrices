#!@perlLocation@

use strict;

use CBIL::Util::Utils;
use GUS::Pipeline::TaskRunAndValidate;

$| = 1;
umask 002;

#work around liniac bug that loses stdout
open(STDOUT, ">&STDERR")     || die "Can't dup stdout";

my $buildDir = $ARGV[0];

if (!($buildDir)) {
    print "usage:  makematrices buildDir\n";
    exit(1);
}

die "Build dir $buildDir doesn't exist" unless -d $buildDir;

print "\n";

my $prevDotsRM = &runRepeatMask($buildDir, "prevDots");

my $assemSeqsRM = &runRepeatMask($buildDir, "assemSeqs");

&runMatrix($buildDir, "prevDots", "prevDots") if $prevDotsRM;

&runMatrix($buildDir, "assemSeqs", "assemSeqs") if $assemSeqsRM;

&runMatrix($buildDir,"prevDots","assemSeqs") if $prevDotsRM && $assemSeqsRM;

print "Done\n";

